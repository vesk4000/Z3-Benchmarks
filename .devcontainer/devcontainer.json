// .devcontainer/devcontainer.json
{
	"name": "Z3-Benchexec-Container",
	"build": {
		"dockerfile": "../Dockerfile",
		"context": ".."
	},
	"workspaceFolder": "/workspace",
	"remoteUser": "benchuser",
	"runArgs": [
		"--privileged",
		"--cap-drop=all"
	],
	"containerEnv": {
		"BENCHEXEC_CONTAINER": "1"
	},
	"customizations": {
		"vscode": {
			"extensions": [
				"ms-python.python",
				"ms-vscode.cpptools",
				"ms-azuretools.vscode-docker"
			],
			"settings": {
				"python.defaultInterpreterPath": "/usr/bin/python3"
			}
		}
	},
	"mounts": [
		"source=${localWorkspaceFolder},target=/workspace,type=bind",
		"source=z3-bench-persistent-setup,target=/opt/persistent-setup,type=volume",
		"source=z3-bench-apt-cache,target=/var/cache/apt,type=volume",
		"source=z3-bench-pip-cache,target=/home/benchuser/.cache/pip,type=volume"
	],
	"postCreateCommand": "bash /opt/persistent-setup/setup.sh || echo 'No persistent setup script found'",
	"postStartCommand": "echo 'Container ready! Available Z3 versions: z3-latest, z3-4.12.0, z3-4.11.2' && echo 'BenchExec ready. Run: benchexec --help'"
}
